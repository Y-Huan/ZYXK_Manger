(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-51441dca"],{"7be7":function(t,e,o){"use strict";o("f0f9")},c22b:function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"app-container"},[o("div",{staticClass:"search_box"},[o("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:t.open_add_role}},[t._v("新增角色")])],1),o("div",{staticClass:"table_box"},[o("el-table",{staticClass:"table",staticStyle:{width:"100%"},attrs:{data:t.roleList,stripe:"",border:"",height:"100%"}},[o("el-table-column",{attrs:{prop:"roleName",label:"角色名称"}}),o("el-table-column",{attrs:{prop:"roleComment",label:"角色描述",width:"500"}}),o("el-table-column",{attrs:{align:"center",prop:"creator",label:"创建人",width:"100"}}),o("el-table-column",{attrs:{sortable:"",prop:"createTime",label:"创建日期",width:"200"}}),o("el-table-column",{attrs:{label:"操作",width:"300",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(o){return t.handleEdit(e.row.roleId)}}},[t._v("编辑权限")]),o("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(o){return t.handleDelete(e.$index,e.row.roleId)}}},[t._v("删除")])]}}])})],1)],1),o("el-dialog",{attrs:{title:"新增角色",visible:t.show_dialog,width:"650px"},on:{"update:visible":function(e){t.show_dialog=e}}},[o("el-form",{attrs:{model:t.role_form}},[o("el-form-item",{attrs:{label:"角色名称","label-width":"120px",required:""}},[o("el-input",{staticStyle:{width:"400px"},attrs:{clearable:"",placeholder:"请输入角色名称",maxlength:"20"},model:{value:t.role_form.roleName,callback:function(e){t.$set(t.role_form,"roleName","string"===typeof e?e.trim():e)},expression:"role_form.roleName"}})],1),o("el-form-item",{attrs:{label:"角色描述","label-width":"120px"}},[o("el-input",{staticStyle:{width:"400px"},attrs:{type:"textarea",rows:"9",resize:"none",maxlength:"200",placeholder:"请输入角色描述","show-word-limit":""},model:{value:t.role_form.roleComment,callback:function(e){t.$set(t.role_form,"roleComment","string"===typeof e?e.trim():e)},expression:"role_form.roleComment"}})],1)],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.show_dialog=!1}}},[t._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:t.add_role}},[t._v("确 定")])],1)],1),o("el-dialog",{attrs:{title:"编辑权限",visible:t.show_auth_dialog,width:"500px"},on:{"update:visible":function(e){t.show_auth_dialog=e}}},[o("el-tree",{ref:"auth_tree",staticStyle:{"max-height":"400px",overflow:"auto"},attrs:{data:t.tree_list,"show-checkbox":"","node-key":"authorityId","check-strictly":!0,"check-on-click-node":!0,"default-expand-all":!0,"default-checked-keys":t.checked_tree,props:{label:"authorityName"}}}),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.show_auth_dialog=!1}}},[t._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:t.update_role_auth}},[t._v("确 定")])],1)],1)],1)},l=[],a=(o("d81d"),o("caad"),o("2532"),o("a434"),o("c24f")),r={data:function(){return{roleList:[],authList:[],show_dialog:!1,show_auth_dialog:!1,roleId:"",role_form:{roleName:"",roleComment:""},checked_tree:[]}},computed:{tree_list:function(){if(this.authList.length){var t=[],e=[];return this.authList.map((function(o){t.push({authorityName:o.menu.authorityName,authorityId:o.menu.authorityId,children:o.authorities}),o.menu.isEnable&&e.push(o.menu.authorityId),o.authorities.length&&o.authorities.map((function(t){t.isEnable&&e.push(t.authorityId)}))})),this.checked_tree=e,t}return this.checked_tree=[],[]}},mounted:function(){this.getList()},methods:{getList:function(){var t=this;Object(a["n"])().then((function(e){t.roleList=e}))},open_add_role:function(){this.role_form={roleName:"",roleComment:""},this.show_dialog=!0},add_role:function(){var t=this;this.role_form.roleName?Object(a["a"])(this.role_form).then((function(e){t.$message.success("添加成功"),t.getList(),t.show_dialog=!1})):this.$message.error("请输入角色名称")},handleEdit:function(t){var e=this;this.roleId=t,Object(a["g"])({roleId:t}).then((function(t){e.authList=t,e.show_auth_dialog=!0}))},update_role_auth:function(){var t=this,e=this.$refs.auth_tree.getCheckedKeys(),o=this.authList;o.map((function(t){e.includes(t.menu.authorityId)?t.menu.isEnable=!0:t.menu.isEnable=!1,t.authorities.length&&t.authorities.map((function(t){e.includes(t.authorityId)?t.isEnable=!0:t.isEnable=!1}))})),this.authList=o,Object(a["m"])({authorities:this.authList,roleId:this.roleId}).then((function(e){t.$message.success("保存成功"),t.show_auth_dialog=!1}))},handleDelete:function(t,e){var o=this;this.$confirm("此操作将永久删除该角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(a["c"])({roleId:e}).then((function(e){o.$message.success("删除成功"),o.roleList.splice(t,1)}))}))}}},n=r,s=(o("7be7"),o("2877")),c=Object(s["a"])(n,i,l,!1,null,"70d1eb78",null);e["default"]=c.exports},f0f9:function(t,e,o){}}]);