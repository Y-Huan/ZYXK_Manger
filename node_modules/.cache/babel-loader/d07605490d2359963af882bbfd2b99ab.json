{"remainingRequest":"C:\\Users\\Kevin Y\\Desktop\\毕业设计相关\\ZYXK_Manager\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Kevin Y\\Desktop\\毕业设计相关\\ZYXK_Manager\\src\\permission.js","dependencies":[{"path":"C:\\Users\\Kevin Y\\Desktop\\毕业设计相关\\ZYXK_Manager\\src\\permission.js","mtime":1645753500000},{"path":"C:\\Users\\Kevin Y\\Desktop\\毕业设计相关\\ZYXK_Manager\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Kevin Y\\Desktop\\毕业设计相关\\ZYXK_Manager\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiQzovVXNlcnMvS2V2aW4gWS9EZXNrdG9wL1x1NkJENVx1NEUxQVx1OEJCRVx1OEJBMVx1NzZGOFx1NTE3My9aWVhLX01hbmFnZXIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiQzovVXNlcnMvS2V2aW4gWS9EZXNrdG9wL1x1NkJENVx1NEUxQVx1OEJCRVx1OEJBMVx1NzZGOFx1NTE3My9aWVhLX01hbmFnZXIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCByb3V0ZXIgZnJvbSAnLi9yb3V0ZXInOwppbXBvcnQgc3RvcmUgZnJvbSAnLi9zdG9yZSc7CmltcG9ydCB7IE1lc3NhZ2UgfSBmcm9tICdlbGVtZW50LXVpJzsKaW1wb3J0IE5Qcm9ncmVzcyBmcm9tICducHJvZ3Jlc3MnOwppbXBvcnQgJ25wcm9ncmVzcy9ucHJvZ3Jlc3MuY3NzJzsKaW1wb3J0IHsgZ2V0VG9rZW4gfSBmcm9tICdAL3V0aWxzL2F1dGgnOwppbXBvcnQgZ2V0UGFnZVRpdGxlIGZyb20gJ0AvdXRpbHMvZ2V0LXBhZ2UtdGl0bGUnOwpOUHJvZ3Jlc3MuY29uZmlndXJlKHsKICBzaG93U3Bpbm5lcjogZmFsc2UKfSk7CnZhciB3aGl0ZUxpc3QgPSBbJy9sb2dpbiddOwpyb3V0ZXIuYmVmb3JlRWFjaCggLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSh0bywgZnJvbSwgbmV4dCkgewogICAgdmFyIGhhc1Rva2VuLCBoYXNJbmZvLCBhY2Nlc3NSb3V0ZXM7CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIE5Qcm9ncmVzcy5zdGFydCgpOwogICAgICAgICAgICBkb2N1bWVudC50aXRsZSA9IGdldFBhZ2VUaXRsZSh0by5tZXRhLnRpdGxlKTsKICAgICAgICAgICAgaGFzVG9rZW4gPSBnZXRUb2tlbigpOwoKICAgICAgICAgICAgaWYgKCFoYXNUb2tlbikgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyNjsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCEodG8ucGF0aCA9PT0gJy9sb2dpbicpKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG5leHQoewogICAgICAgICAgICAgIHBhdGg6ICcvJwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgTlByb2dyZXNzLmRvbmUoKTsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI0OwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgIGhhc0luZm8gPSBzdG9yZS5nZXR0ZXJzLnVzZXJJbmZvOwoKICAgICAgICAgICAgaWYgKCFoYXNJbmZvKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIyOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoIXN0b3JlLmdldHRlcnMucGVybWlzc2lvbl9yb3V0ZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE1OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBuZXh0KCk7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMDsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE3OwogICAgICAgICAgICByZXR1cm4gc3RvcmUuZGlzcGF0Y2goJ3Blcm1pc3Npb24vZ2VuZXJhdGVSb3V0ZXMnLCBzdG9yZS5nZXR0ZXJzLnJvbGVzKTsKCiAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICBhY2Nlc3NSb3V0ZXMgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICByb3V0ZXIuYWRkUm91dGVzKGFjY2Vzc1JvdXRlcyk7CiAgICAgICAgICAgIG5leHQoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCB0byksIHt9LCB7CiAgICAgICAgICAgICAgcmVwbGFjZTogdHJ1ZQogICAgICAgICAgICB9KSk7CgogICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI0OwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDIyOgogICAgICAgICAgICBuZXh0KCIvbG9naW4/cmVkaXJlY3Q9Ii5jb25jYXQodG8ucGF0aCkpOwogICAgICAgICAgICBOUHJvZ3Jlc3MuZG9uZSgpOwoKICAgICAgICAgIGNhc2UgMjQ6CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyNzsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAyNjoKICAgICAgICAgICAgaWYgKHdoaXRlTGlzdC5pbmRleE9mKHRvLnBhdGgpICE9PSAtMSkgewogICAgICAgICAgICAgIG5leHQoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBuZXh0KCIvbG9naW4/cmVkaXJlY3Q9Ii5jb25jYXQodG8ucGF0aCkpOwogICAgICAgICAgICAgIE5Qcm9ncmVzcy5kb25lKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICBjYXNlIDI3OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUpOwogIH0pKTsKCiAgcmV0dXJuIGZ1bmN0aW9uIChfeCwgX3gyLCBfeDMpIHsKICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpKTsKcm91dGVyLmFmdGVyRWFjaChmdW5jdGlvbiAoKSB7CiAgTlByb2dyZXNzLmRvbmUoKTsKfSk7"},{"version":3,"sources":["C:/Users/Kevin Y/Desktop/毕业设计相关/ZYXK_Manager/src/permission.js"],"names":["router","store","Message","NProgress","getToken","getPageTitle","configure","showSpinner","whiteList","beforeEach","to","from","next","start","document","title","meta","hasToken","path","done","hasInfo","getters","userInfo","permission_routes","length","dispatch","roles","accessRoutes","addRoutes","replace","indexOf","afterEach"],"mappings":";;;AAAA,OAAOA,MAAP,MAAmB,UAAnB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,SAASC,OAAT,QAAwB,YAAxB;AACA,OAAOC,SAAP,MAAsB,WAAtB;AACA,OAAO,yBAAP;AACA,SAASC,QAAT,QAAyB,cAAzB;AACA,OAAOC,YAAP,MAAyB,wBAAzB;AACAF,SAAS,CAACG,SAAV,CAAoB;AAAEC,EAAAA,WAAW,EAAE;AAAf,CAApB;AACA,IAAMC,SAAS,GAAG,CAAC,QAAD,CAAlB;AACAR,MAAM,CAACS,UAAP;AAAA,qEAAkB,iBAAMC,EAAN,EAAUC,IAAV,EAAgBC,IAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAChBT,YAAAA,SAAS,CAACU,KAAV;AACAC,YAAAA,QAAQ,CAACC,KAAT,GAAiBV,YAAY,CAACK,EAAE,CAACM,IAAH,CAAQD,KAAT,CAA7B;AACME,YAAAA,QAHU,GAGCb,QAAQ,EAHT;;AAAA,iBAIZa,QAJY;AAAA;AAAA;AAAA;;AAAA,kBAKVP,EAAE,CAACQ,IAAH,KAAY,QALF;AAAA;AAAA;AAAA;;AAMZN,YAAAA,IAAI,CAAC;AAAEM,cAAAA,IAAI,EAAE;AAAR,aAAD,CAAJ;AACAf,YAAAA,SAAS,CAACgB,IAAV;AAPY;AAAA;;AAAA;AASNC,YAAAA,OATM,GASInB,KAAK,CAACoB,OAAN,CAAcC,QATlB;;AAAA,iBAURF,OAVQ;AAAA;AAAA;AAAA;;AAAA,iBAWPnB,KAAK,CAACoB,OAAN,CAAcE,iBAAd,CAAgCC,MAXzB;AAAA;AAAA;AAAA;;AAYRZ,YAAAA,IAAI;AAZI;AAAA;;AAAA;AAAA;AAAA,mBAcmBX,KAAK,CAACwB,QAAN,CAAe,2BAAf,EAA4CxB,KAAK,CAACoB,OAAN,CAAcK,KAA1D,CAdnB;;AAAA;AAcFC,YAAAA,YAdE;AAeR3B,YAAAA,MAAM,CAAC4B,SAAP,CAAiBD,YAAjB;AACAf,YAAAA,IAAI,iCAAMF,EAAN;AAAUmB,cAAAA,OAAO,EAAE;AAAnB,eAAJ;;AAhBQ;AAAA;AAAA;;AAAA;AAmBVjB,YAAAA,IAAI,2BAAoBF,EAAE,CAACQ,IAAvB,EAAJ;AACAf,YAAAA,SAAS,CAACgB,IAAV;;AApBU;AAAA;AAAA;;AAAA;AAwBd,gBAAIX,SAAS,CAACsB,OAAV,CAAkBpB,EAAE,CAACQ,IAArB,MAA+B,CAAC,CAApC,EAAuC;AACrCN,cAAAA,IAAI;AACL,aAFD,MAEO;AACLA,cAAAA,IAAI,2BAAoBF,EAAE,CAACQ,IAAvB,EAAJ;AACAf,cAAAA,SAAS,CAACgB,IAAV;AACD;;AA7Ba;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAlB;;AAAA;AAAA;AAAA;AAAA;AAiCAnB,MAAM,CAAC+B,SAAP,CAAiB,YAAM;AACrB5B,EAAAA,SAAS,CAACgB,IAAV;AACD,CAFD","sourcesContent":["import router from './router'\nimport store from './store'\nimport { Message } from 'element-ui'\nimport NProgress from 'nprogress'\nimport 'nprogress/nprogress.css'\nimport { getToken } from '@/utils/auth'\nimport getPageTitle from '@/utils/get-page-title'\nNProgress.configure({ showSpinner: false })\nconst whiteList = ['/login']\nrouter.beforeEach(async(to, from, next) => {\n  NProgress.start()\n  document.title = getPageTitle(to.meta.title)\n  const hasToken = getToken();\n  if (hasToken) {\n    if (to.path === '/login') {\n      next({ path: '/' })\n      NProgress.done()\n    } else {\n      const hasInfo = store.getters.userInfo;\n      if (hasInfo) {\n        if(store.getters.permission_routes.length){\n          next();\n        }else{\n          const accessRoutes = await store.dispatch('permission/generateRoutes', store.getters.roles)\n          router.addRoutes(accessRoutes)\n          next({ ...to, replace: true })\n        }\n      } else {\n        next(`/login?redirect=${to.path}`)\n        NProgress.done()\n      }\n    }\n  } else {\n    if (whiteList.indexOf(to.path) !== -1) {\n      next()\n    } else {\n      next(`/login?redirect=${to.path}`)\n      NProgress.done()\n    }\n  }\n})\n\nrouter.afterEach(() => {\n  NProgress.done()\n})\n"]}]}